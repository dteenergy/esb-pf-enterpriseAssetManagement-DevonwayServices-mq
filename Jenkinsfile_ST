pipeline {
  agent any
    stages {

	stage('Checkout Code'){
            steps{
                checkout([$class: 'GitSCM', branches: [[name: '*/feature-IIB']], doGenerateSubmoduleConfigurations: false, extensions: [[$class: 'RelativeTargetDirectory', relativeTargetDir: '.']], submoduleCfg: [], userRemoteConfigs: [[url: 'git@github.com:dteenergy/esb-pf-enterpriseAssetManagement-DevonwayServices-mq.git']]])
            }
       }
	stage('MQ Objects Creation on ESBMQST') {
		steps{
		script{
		     def remote = [:]
			remote.name = "lnx1359"
			remote.host = "lnx1359.dteco.com"
			remote.allowAnyHosts = true
			remote.user = "mqmst"
			remote.logLevel = "FINEST"
			withCredentials([sshUserPrivateKey(credentialsId: 'esbci4', keyFileVariable: 'identity', passphraseVariable: '', usernameVariable: 'userName')]) {
			remote.identityFile = identity
			sshPut remote: remote, from: 'deploymq.sh', into: './deploymq.sh'
			sshCommand remote: remote, command: "ls -ltr"
			sshCommand remote: remote, command: "chmod 750 ./deploymq.sh"
           		sshCommand remote: remote, command: "sh ./deploymq.sh ESBMQST ST"
			sshRemove remote: remote, path: "deploymq.sh"
		}
		}
        }
		}

}
}
